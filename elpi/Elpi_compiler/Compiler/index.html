<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Compiler (elpi.Elpi_compiler.Compiler)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">elpi</a> &#x00BB; <a href="../index.html">Elpi_compiler</a> &#x00BB; Compiler</nav><header class="odoc-preamble"><h1>Module <code><span>Elpi_compiler.Compiler</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-flags"><a href="#type-flags" class="anchor"></a><code><span><span class="keyword">type</span> flags</span><span> = </span><span>{</span></code><ol><li id="type-flags.defined_variables" class="def record field anchored"><a href="#type-flags.defined_variables" class="anchor"></a><code><span>defined_variables : <a href="../../Elpi_util/Util/StrSet/index.html#type-t">Elpi_util.Util.StrSet.t</a>;</span></code></li><li id="type-flags.print_units" class="def record field anchored"><a href="#type-flags.print_units" class="anchor"></a><code><span>print_units : bool;</span></code></li><li id="type-flags.time_typechecking" class="def record field anchored"><a href="#type-flags.time_typechecking" class="anchor"></a><code><span>time_typechecking : bool;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_flags"><a href="#val-default_flags" class="anchor"></a><code><span><span class="keyword">val</span> default_flags : <a href="#type-flags">flags</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-builtins"><a href="#type-builtins" class="anchor"></a><code><span><span class="keyword">type</span> builtins</span><span> = string * <span><a href="../../Elpi_runtime/Data/BuiltInPredicate/index.html#type-declaration">Elpi_runtime.Data.BuiltInPredicate.declaration</a> list</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-header"><a href="#type-header" class="anchor"></a><code><span><span class="keyword">type</span> header</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-header_of_ast"><a href="#val-header_of_ast" class="anchor"></a><code><span><span class="keyword">val</span> header_of_ast : 
  <span><span class="label">flags</span>:<a href="#type-flags">flags</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">parser</span>:<span>(<span class="keyword">module</span> <a href="../../Elpi_parser/Parse/module-type-Parser/index.html">Elpi_parser.Parse.Parser</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Elpi_runtime/Data/State/index.html#type-descriptor">Elpi_runtime.Data.State.descriptor</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Compiler_data/QuotationHooks/index.html#type-descriptor">Compiler_data.QuotationHooks.descriptor</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Elpi_runtime/Data/HoasHooks/index.html#type-descriptor">Elpi_runtime.Data.HoasHooks.descriptor</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Elpi_runtime/Data/CalcHooks/index.html#type-descriptor">Elpi_runtime.Data.CalcHooks.descriptor</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-builtins">builtins</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Elpi_parser/Ast/Program/index.html#type-t">Elpi_parser.Ast.Program.t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-header">header</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-program"><a href="#type-program" class="anchor"></a><code><span><span class="keyword">type</span> program</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-program_of_ast"><a href="#val-program_of_ast" class="anchor"></a><code><span><span class="keyword">val</span> program_of_ast : 
  <span><span class="label">flags</span>:<a href="#type-flags">flags</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">header</span>:<a href="#type-header">header</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Elpi_parser/Ast/Program/index.html#type-t">Elpi_parser.Ast.Program.t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-program">program</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-scoped_program"><a href="#type-scoped_program" class="anchor"></a><code><span><span class="keyword">type</span> scoped_program</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-scoped_of_ast"><a href="#val-scoped_of_ast" class="anchor"></a><code><span><span class="keyword">val</span> scoped_of_ast : 
  <span><span class="label">flags</span>:<a href="#type-flags">flags</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">header</span>:<a href="#type-header">header</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Elpi_parser/Ast/Program/index.html#type-t">Elpi_parser.Ast.Program.t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-scoped_program">scoped_program</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-checked_compilation_unit"><a href="#type-checked_compilation_unit" class="anchor"></a><code><span><span class="keyword">type</span> checked_compilation_unit</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-unchecked_compilation_unit"><a href="#type-unchecked_compilation_unit" class="anchor"></a><code><span><span class="keyword">type</span> unchecked_compilation_unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-empty_base"><a href="#val-empty_base" class="anchor"></a><code><span><span class="keyword">val</span> empty_base : <span><span class="label">header</span>:<a href="#type-header">header</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-program">program</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unit_of_scoped"><a href="#val-unit_of_scoped" class="anchor"></a><code><span><span class="keyword">val</span> unit_of_scoped : 
  <span><span class="label">flags</span>:<a href="#type-flags">flags</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">header</span>:<a href="#type-header">header</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?builtins</span>:<span><a href="#type-builtins">builtins</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-scoped_program">scoped_program</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-unchecked_compilation_unit">unchecked_compilation_unit</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-append_unit"><a href="#val-append_unit" class="anchor"></a><code><span><span class="keyword">val</span> append_unit : 
  <span><span class="label">flags</span>:<a href="#type-flags">flags</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">base</span>:<a href="#type-program">program</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-checked_compilation_unit">checked_compilation_unit</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-program">program</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-check_unit"><a href="#val-check_unit" class="anchor"></a><code><span><span class="keyword">val</span> check_unit : 
  <span><span class="label">flags</span>:<a href="#type-flags">flags</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">base</span>:<a href="#type-program">program</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-unchecked_compilation_unit">unchecked_compilation_unit</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-checked_compilation_unit">checked_compilation_unit</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-checked_compilation_unit_signature"><a href="#type-checked_compilation_unit_signature" class="anchor"></a><code><span><span class="keyword">type</span> checked_compilation_unit_signature</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-signature_of_checked_compilation_unit"><a href="#val-signature_of_checked_compilation_unit" class="anchor"></a><code><span><span class="keyword">val</span> signature_of_checked_compilation_unit : 
  <span><a href="#type-checked_compilation_unit">checked_compilation_unit</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-checked_compilation_unit_signature">checked_compilation_unit_signature</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-append_unit_signature"><a href="#val-append_unit_signature" class="anchor"></a><code><span><span class="keyword">val</span> append_unit_signature : 
  <span><span class="label">flags</span>:<a href="#type-flags">flags</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">base</span>:<a href="#type-program">program</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-checked_compilation_unit_signature">checked_compilation_unit_signature</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-program">program</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-query"><a href="#type-query" class="anchor"></a><code><span><span class="keyword">type</span> query</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-query_of_ast"><a href="#val-query_of_ast" class="anchor"></a><code><span><span class="keyword">val</span> query_of_ast : 
  <span><a href="#type-program">program</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Elpi_parser/Ast/Goal/index.html#type-t">Elpi_parser.Ast.Goal.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="../../Elpi_runtime/Data/State/index.html#type-t">Elpi_runtime.Data.State.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../Elpi_runtime/Data/State/index.html#type-t">Elpi_runtime.Data.State.t</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-query">query</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-query_of_scoped_term"><a href="#val-query_of_scoped_term" class="anchor"></a><code><span><span class="keyword">val</span> query_of_scoped_term : 
  <span><a href="#type-program">program</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="../../Elpi_runtime/Data/State/index.html#type-t">Elpi_runtime.Data.State.t</a> <span class="arrow">&#45;&gt;</span></span>
    <a href="../../Elpi_runtime/Data/State/index.html#type-t">Elpi_runtime.Data.State.t</a> * <a href="../Compiler_data/ScopedTerm/index.html#type-t">Compiler_data.ScopedTerm.t</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-query">query</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-query_of_raw_term"><a href="#val-query_of_raw_term" class="anchor"></a><code><span><span class="keyword">val</span> query_of_raw_term : 
  <span><a href="#type-program">program</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="../../Elpi_runtime/Data/State/index.html#type-t">Elpi_runtime.Data.State.t</a> <span class="arrow">&#45;&gt;</span></span>
    <a href="../../Elpi_runtime/Data/State/index.html#type-t">Elpi_runtime.Data.State.t</a>
    * <a href="../../Elpi_runtime/Data/index.html#type-term">Elpi_runtime.Data.term</a>
    * <a href="../../Elpi_runtime/Data/Conversion/index.html#type-extra_goals">Elpi_runtime.Data.Conversion.extra_goals</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-query">query</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-total_type_checking_time"><a href="#val-total_type_checking_time" class="anchor"></a><code><span><span class="keyword">val</span> total_type_checking_time : <span><a href="#type-query">query</a> <span class="arrow">&#45;&gt;</span></span> float</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-optimize_query"><a href="#val-optimize_query" class="anchor"></a><code><span><span class="keyword">val</span> optimize_query : <span><a href="#type-query">query</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../Elpi_runtime/Data/index.html#type-executable">Elpi_runtime.Data.executable</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-relocate_closed_term"><a href="#val-relocate_closed_term" class="anchor"></a><code><span><span class="keyword">val</span> relocate_closed_term : 
  <span><span class="label">from</span>:<a href="../../Elpi_runtime/Data/index.html#type-symbol_table">Elpi_runtime.Data.symbol_table</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">to_</span>:<a href="#type-program">program</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Elpi_runtime/Data/index.html#type-term">Elpi_runtime.Data.term</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../../Elpi_runtime/Data/index.html#type-term">Elpi_runtime.Data.term</a>, string)</span> <span class="xref-unresolved">Stdlib</span>.Result.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_program"><a href="#val-pp_program" class="anchor"></a><code><span><span class="keyword">val</span> pp_program : 
  <span><span>(<span><span class="label">pp_ctx</span>:<a href="../../Elpi_runtime/Data/index.html#type-pp_ctx">Elpi_runtime.Data.pp_ctx</a> <span class="arrow">&#45;&gt;</span></span>
    <span><span class="label">depth</span>:int <span class="arrow">&#45;&gt;</span></span>
    <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
    <span><a href="../../Elpi_runtime/Data/index.html#type-term">Elpi_runtime.Data.term</a> <span class="arrow">&#45;&gt;</span></span>
    unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-program">program</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_goal"><a href="#val-pp_goal" class="anchor"></a><code><span><span class="keyword">val</span> pp_goal : 
  <span><span>(<span><span class="label">pp_ctx</span>:<a href="../../Elpi_runtime/Data/index.html#type-pp_ctx">Elpi_runtime.Data.pp_ctx</a> <span class="arrow">&#45;&gt;</span></span>
    <span><span class="label">depth</span>:int <span class="arrow">&#45;&gt;</span></span>
    <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
    <span><a href="../../Elpi_runtime/Data/index.html#type-term">Elpi_runtime.Data.term</a> <span class="arrow">&#45;&gt;</span></span>
    unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-query">query</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-elpi_language"><a href="#val-elpi_language" class="anchor"></a><code><span><span class="keyword">val</span> elpi_language : <a href="../Compiler_data/Scope/index.html#type-language">Compiler_data.Scope.language</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-elpi"><a href="#val-elpi" class="anchor"></a><code><span><span class="keyword">val</span> elpi : <a href="../Compiler_data/QuotationHooks/index.html#type-quotation">Compiler_data.QuotationHooks.quotation</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-uvk"><a href="#val-uvk" class="anchor"></a><code><span><span class="keyword">val</span> uvk : 
  <span><span><a href="../../Elpi_runtime/Data/index.html#type-uvar_body">Elpi_runtime.Data.uvar_body</a> <a href="../../Elpi_util/Util/StrMap/index.html#type-t">Elpi_util.Util.StrMap.t</a></span>
    <a href="../../Elpi_runtime/Data/State/index.html#type-component">Elpi_runtime.Data.State.component</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Elpi_runtime/Data/index.html#type-uvar_body">Elpi_runtime.Data.uvar_body</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compile_term_to_raw_term"><a href="#val-compile_term_to_raw_term" class="anchor"></a><code><span><span class="keyword">val</span> compile_term_to_raw_term : 
  <span><span class="optlabel">?check</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Elpi_runtime/Data/State/index.html#type-t">Elpi_runtime.Data.State.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-program">program</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?ctx</span>:<span><a href="../../Elpi_util/Util/index.html#type-constant">Elpi_util.Util.constant</a> <a href="../Compiler_data/Scope/Map/index.html#type-t">Compiler_data.Scope.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">depth</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Compiler_data/ScopedTerm/index.html#type-t">Compiler_data.ScopedTerm.t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../../Elpi_runtime/Data/State/index.html#type-t">Elpi_runtime.Data.State.t</a> * <a href="../../Elpi_runtime/Data/index.html#type-term">Elpi_runtime.Data.term</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-runtime_hack_term_to_raw_term"><a href="#val-runtime_hack_term_to_raw_term" class="anchor"></a><code><span><span class="keyword">val</span> runtime_hack_term_to_raw_term : 
  <span><a href="../../Elpi_runtime/Data/State/index.html#type-t">Elpi_runtime.Data.State.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-program">program</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?ctx</span>:<span><a href="../../Elpi_util/Util/index.html#type-constant">Elpi_util.Util.constant</a> <a href="../Compiler_data/Scope/Map/index.html#type-t">Compiler_data.Scope.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">depth</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Compiler_data/ScopedTerm/index.html#type-t">Compiler_data.ScopedTerm.t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../../Elpi_runtime/Data/index.html#type-term">Elpi_runtime.Data.term</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-global_name_to_constant"><a href="#val-global_name_to_constant" class="anchor"></a><code><span><span class="keyword">val</span> global_name_to_constant : 
  <span><a href="../../Elpi_runtime/Data/State/index.html#type-t">Elpi_runtime.Data.State.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <a href="../../Elpi_util/Util/index.html#type-constant">Elpi_util.Util.constant</a></span></code></div></div></div></body></html>
